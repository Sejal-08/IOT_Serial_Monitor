<!DOCTYPE html>
<html>
<head>
  <title>IOT Serial Monitor</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="light-mode">
  <nav>
    <ul class="nav-links">
      <li>
        <button class="theme-toggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
      </li>
    </ul>
  </nav>

  <div class="main-container">
    <div class="left-panel">
      <section class="control-section">
        <h3><i class="fas fa-plug"></i> Serial Port</h3>
        <div class="controls">
          <button class="action-button" onclick="listPorts()"><i class="fas fa-list"></i> List Ports</button>
          <select id="ports" class="input-field"></select>
          <select id="baud-rate" class="input-field">
            <option value="9600">9600</option>
            <option value="19200">19200</option>
            <option value="38400">38400</option>
            <option value="57600">57600</option>
            <option value="115200" selected>115200</option>
            <option value="230400">230400</option>
          </select>
          <button class="action-button" onclick="connectPort()"><i class="fas fa-play"></i> Connect</button>
          <button class="action-button" onclick="disconnectPort()"><i class="fas fa-stop"></i> Disconnect</button>
        </div>
      </section>

        <section class="control-section">
        <h3><i class="fas fa-clock"></i> Interval Configuration</h3>
       <div class="controls">
          <div class="interval-wrapper">
            <input type="number" id="interval" class="input-field" placeholder="Interval" min="1" oninput="updateIntervalDisplay()">
            <span class="interval-suffix">(seconds)</span>
          </div>
          <button class="action-button" onclick="setInterval()"><i class="fas fa-save"></i> Set Interval</button>
        </div>
      </section>

      <section class="control-section">
        <div class="controls">
          <button id="restart-button" class="action-button" onclick="restartDevice()">
            <i class="fas fa-redo"></i> Restart Device
          </button>
        </div>
      </section>

      <section class="control-section" id="sensors-section">
        <h3><i class="fas fa-microchip"></i> Sensor Protocols</h3>
        <div class="controls">
          <select id="sensor-select" class="input-field" onchange="updateSensorUI()">
            <option value="" disabled selected>Select a Sensor Protocol</option>
            <option value="I2C">I2C</option>
             <option value="ADC">ADC</option>
            <option value="RS485">RS485</option>
            <option value="SPI">SPI</option>
            <option value="Analog">Analog</option>
          </select>
        </div>
        <div class="controls">
          <select id="sensor-dropdown" class="input-field" onchange="selectSensor(this.value)">
            <option value="" disabled selected>Select a Sensor</option>
          </select>
        </div>
        <div id="sensor-data" class="sensor-data-container">
          <!-- Selected sensor data will be dynamically inserted here -->
        </div>
      </section>
    </div>

    <div class="right-panel">
      <div class="container">
        <section class="control-section" id="sensor-visualization-section" style="display: none;">
          <h3><i class="fas fa-chart-line"></i> Sensor Data Visualization</h3>
          <div class="sensor-cards">
               <!-- Temperature -->
            <div id="thermometer-container" class="thermometer-container" style="display: none;">
              <h4>Temperature</h4>
              <div id="thermometer-value" class="sensor-value" style="margin-bottom: 8px;"></div>
              <svg width="100" height="220" viewBox="0 0 100 220" class="thermometer">
                <defs>
                  <radialGradient id="liquidGlow" cx="50%" cy="50%" r="60%">
                    <stop offset="0%" stop-color="#FFFFC8" />
                    <stop offset="60%" stop-color="#FFF078" />
                    <stop offset="100%" stop-color="#FFD23C" />
                  </radialGradient>
                </defs>
                <rect x="40" y="20" width="20" height="160" rx="10" ry="10"
                      fill="#e0e7ff" stroke="#333" stroke-width="2"/>
                <rect id="thermometer-fill" x="42" y="180" width="16" height="0"
                      rx="8" ry="8" fill="url(#liquidGlow)"/>
                <circle cx="50" cy="180" r="10"
                        fill="#e0e7ff" stroke="#333" stroke-width="2"/>
                <circle id="thermometer-bulb" cx="50" cy="180" r="8"
                        fill="url(#liquidGlow)"/>
                <line x1="65" y1="20"  x2="70"  y2="20"  stroke="#333" stroke-width="2"/>
                <text x="75" y="25"  font-size="12" fill="var(--text-color)">50°C</text>
                <line x1="65" y1="52"  x2="70"  y2="52"  stroke="#333" stroke-width="1"/>
                <text x="75" y="57"  font-size="12" fill="var(--text-color)">40°C</text>
                <line x1="65" y1="84"  x2="70"  y2="84"  stroke="#333" stroke-width="1"/>
                <text x="75" y="89"  font-size="12" fill="var(--text-color)">30°C</text>
                <line x1="65" y1="116" x2="70"  y2="116" stroke="#333" stroke-width="1"/>
                <text x="75" y="121" font-size="12" fill="var(--text-color)">20°C</text>
                <line x1="65" y1="148" x2="70"  y2="148" stroke="#333" stroke-width="1"/>
                <text x="75" y="153" font-size="12" fill="var(--text-color)">10°C</text>
                <line x1="65" y1="180" x2="70"  y2="180" stroke="#333" stroke-width="2"/>
                <text x="75" y="185" font-size="12" fill="var(--text-color)">0°C</text>
              </svg>
            </div>


            <!-- Humidity -->
            <div id="humidity-card" class="wave-card-container" style="display: none;">
              <h4>Humidity</h4>
              <div class="wave-card-content">
                <i class="fas fa-water-drop-outlined"></i>
                <span id="humidity-value" class="sensor-value"></span>
              </div>
              <svg id="humidity-wave" width="100%" height="80" viewBox="0 0 100 100" preserveAspectRatio="none">
                <defs>
                  <linearGradient id="waveGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" id="waveColor1" style="stop-color:#3d8eb4;stop-opacity:0.5"/>
                    <stop offset="100%" id="waveColor2" style="stop-color:#0474a8;stop-opacity:1"/>
                  </linearGradient>
                </defs>
                <path id="wavePath" d="M 0 100 V 100 H 0 Z" fill="url(#waveGradient)"/>
              </svg>
            </div>

      
          <!-- PRESSURE -->
<div id="pressure-card" class="card-container">
  <h4>Pressure</h4>
  <div class="card-content">
    <div id="pressure-value" class="main-value">1038</div>
  </div>

  <!-- full-circle gauge -->
  <div class="gauge-container">
    <svg class="gauge-svg" viewBox="0 0 200 200">
      <defs>
        <!-- gradient that follows .light-mode / .dark-mode -->
        <linearGradient id="gaugeGradientLight" x1="0" y1="0" x2="200" y2="200">
          <stop offset="0%"  stop-color="#06b6d4"/>
          <stop offset="25%" stop-color="#10b981"/>
          <stop offset="50%" stop-color="#f59e0b"/>
          <stop offset="100%" stop-color="#ef4444"/>
        </linearGradient>
        <linearGradient id="gaugeGradientDark" x1="0" y1="0" x2="200" y2="200">
          <stop offset="0%"  stop-color="#34d399"/>
          <stop offset="50%" stop-color="#fbbf24"/>
          <stop offset="100%" stop-color="#f87171"/>
        </linearGradient>
      </defs>

      <!-- full-circle background -->
      <circle class="gauge-outer"
              cx="100" cy="100" r="90"
              stroke-width="10"/>

      <!-- animated value arc -->
      <circle id="gauge-fill"
              class="gauge-fill"
              cx="100" cy="100" r="90"
              stroke-width="10"
              stroke-linecap="round"
              stroke-dasharray="0 565.48"
              stroke-dashoffset="0"/>
    </svg>

    <!-- centre read-out -->
    <div class="gauge-inner">
      <span id="pressure-value-inner" class="pressure-value">1038</span>
    </div>
  </div>
</div>
            <!-- Light Intensity Card with Sun/Moon Toggle -->
            <div id="light-card" class="card-container" style="display: none; position: relative; border-radius: 15px; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1); padding: 15px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
              <h4>Light Intensity</h4>
              <div id="light-value" class="sensor-value"></div>
              <!-- Sun SVG -->
              <svg id="light-sun" width="120" height="120" viewBox="0 0 120 120" style="display: none; margin: 10px auto;">
                <defs>
                  <radialGradient id="sunGradient" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" style="stop-color:#ffeb3b; stop-opacity:1"/>
                    <stop offset="60%" style="stop-color:#ff9800; stop-opacity:0.8"/>
                    <stop offset="100%" style="stop-color:#ff6b00; stop-opacity:0.4"/>
                  </radialGradient>
                  <filter id="sunGlow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                    <feMerge>
                      <feMergeNode in="coloredBlur"/>
                      <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                <!-- Animated rays container -->
                <g id="sun-rays" transform="translate(60, 60)">
                  <line class="sun-ray" x1="0" y1="0" x2="0" y2="-40" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-35;-50;-35" dur="4s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="28" y2="-28" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="0.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="24;34;24" dur="4s" begin="0.5s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-24;-34;-24" dur="4s" begin="0.5s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="40" y2="0" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="1s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="35;50;35" dur="4s" begin="1s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="28" y2="28" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="1.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="24;34;24" dur="4s" begin="1.5s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="24;34;24" dur="4s" begin="1.5s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="0" y2="40" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="2s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="35;50;35" dur="4s" begin="2s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="-28" y2="28" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="2.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-24;-34;-24" dur="4s" begin="2.5s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="24;34;24" dur="4s" begin="2.5s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="-40" y2="0" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="3s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-35;-50;-35" dur="4s" begin="3s" repeatCount="indefinite"/>
                  </line>
                  <line class="sun-ray" x1="0" y1="0" x2="-28" y2="-28" stroke="#4b2e00" stroke-width="4" opacity="0">
                    <animate attributeName="opacity" values="0;0.9;0" dur="4s" begin="3.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-24;-34;-24" dur="4s" begin="3.5s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-24;-34;-24" dur="4s" begin="3.5s" repeatCount="indefinite"/>
                  </line>
                </g>
                <!-- Central sun circle -->
                <circle id="sun-circle" cx="60" cy="60" r="24" fill="url(#sunGradient)" filter="url(#sunGlow)"/>
                <!-- Inner glow circle -->
                <circle cx="60" cy="60" r="24" fill="none" stroke="#fff" stroke-width="1" opacity="0.3">
                  <animate attributeName="r" values="24;28;24" dur="4s" repeatCount="indefinite"/>
                  <animate attributeName="opacity" values="0.3;0.1;0.3" dur="4s" repeatCount="indefinite"/>
                </circle>
              </svg>
              <!-- Moon SVG -->
              <svg id="light-moon" width="120" height="120" viewBox="0 0 120 120" style="display: none; margin: 10px auto;">
                <defs>
                  <radialGradient id="moonGradient" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" style="stop-color:#e6e6fa; stop-opacity:0.9"/>
                    <stop offset="70%" style="stop-color:#b0c4de; stop-opacity:0.6"/>
                    <stop offset="100%" style="stop-color:#4682b4; stop-opacity:0.3"/>
                  </radialGradient>
                  <filter id="moonGlow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                    <feMerge>
                      <feMergeNode in="coloredBlur"/>
                      <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                <!-- Moon shape with crescent effect -->
                <path id="moon-shape" d="M60 20 A40 40 0 0 1 60 100 A40 40 0 0 1 60 20 C80 30 80 90 60 100" fill="url(#moonGradient)" filter="url(#moonGlow)"/>
                <!-- Sparkles for moon -->
                <g id="moon-sparkles">
                  <circle cx="40" cy="40" r="2" fill="#fff" opacity="0">
                    <animate attributeName="opacity" values="0;0.7;0" dur="2s" repeatCount="indefinite"/>
                    <animate attributeName="r" values="2;3;2" dur="2s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="80" cy="80" r="2" fill="#fff" opacity="0">
                    <animate attributeName="opacity" values="0;0.7;0" dur="2.5s" begin="0.5s" repeatCount="indefinite"/>
                    <animate attributeName="r" values="2;3;2" dur="2.5s" begin="0.5s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="50" cy="70" r="2" fill="#fff" opacity="0">
                    <animate attributeName="opacity" values="0;0.7;0" dur="3s" begin="1s" repeatCount="indefinite"/>
                    <animate attributeName="r" values="2;3;2" dur="3s" begin="1s" repeatCount="indefinite"/>
                  </circle>
                </g>
              </svg>
            </div>
<!-- Rain Gauge -->
<div id="rain-gauge-card" class="rain-gauge-card">
  <div class="rain-header">
    <i class="fa-solid fa-cloud-rain"></i>
    <div id="rain-value" class="rain-value">0.0 mm</div>
  </div>

  <div class="seesaw-container">
    <div class="seesaw">
      <div class="outer-base"></div>
      <div class="base"></div>
      <div class="pole left"></div>
      <div class="pole right"></div>
      <div class="support"></div>
      <div id="roof" class="roof"></div>
    </div>
  </div>

  <div class="water-container">
    <div id="water-wave" class="water-wave"></div>
  </div>
</div>
      <!-- LIS3DH Acceleration -->
<div id="lis3dh-card" class="card-container" style="display: none; min-width: 300px;">
  <h4>Acceleration</h4>
  <div id="lis3dh-x-value" class="sensor-value">X: 0.00 m/s²</div>
  <div id="lis3dh-y-value" class="sensor-value">Y: 0.00 m/s²</div>
  <div id="lis3dh-z-value" class="sensor-value">Z: 0.00 m/s²</div>
  <div class="cube-container" style="perspective: 1000px; width: 150px; height: 150px; margin: auto; position: relative;">
    <div id="accel-cube-wrapper" style="width: 150px; height: 150px; position: relative; transform-style: preserve-3d; user-select: none;">
      <div id="accel-cube" style="width: 150px; height: 150px; position: relative; transform-style: preserve-3d; transition: transform 0.3s ease;">
        <!-- Cube faces (wireframe) -->
        <div class="face front" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateY(0deg) translateZ(75px);"></div>
        <div class="face back" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateY(180deg) translateZ(75px);"></div>
        <div class="face right" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateY(90deg) translateZ(75px);"></div>
        <div class="face left" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateY(-90deg) translateZ(75px);"></div>
        <div class="face top" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateX(90deg) translateZ(75px);"></div>
        <div class="face bottom" style="position: absolute; width: 150px; height: 150px; background: transparent; border: 1px solid #333; transform: rotateX(-90deg) translateZ(75px);"></div>
        <!-- Axes -->
        <div class="axis x" style="position: absolute; top: 50%; left: 0; width: 150px; height: 1px; background: red; transform: translateY(-50%);"></div>
        <div class="axis y" style="position: absolute; left: 50%; top: 0; width: 1px; height: 150px; background: green; transform: translateX(-50%);"></div>
        <div class="axis z" style="position: absolute; top: 50%; left: 50%; width: 150px; height: 1px; background: blue; transform: translate(-50%, -50%) rotateX(90deg);"></div>
        <!-- Axis labels (placed in 3D space) -->
        <div class="axis-label x" style="position: absolute; top:50%; left:50%; transform: translate(-50%, -50%) translate3d(75px, 0, 0); color: red; font-size: 12px;">+X</div>
        <div class="axis-label y" style="position: absolute; top:50%; left:50%; transform: translate(-50%, -50%) translate3d(0, -75px, 0); color: green; font-size: 12px;">+Y</div>
        <div class="axis-label z" style="position: absolute; top:50%; left:50%; transform: translate(-50%, -50%) translate3d(0, 0, 75px); color: blue; font-size: 12px;">+Z</div>
        <!-- Inner circle (ball) -->
        <div id="accel-ball" style="position: absolute; top:50%; left:50%; width: 20px; height: 20px; background: black; border-radius: 50%; transform: translate(-50%, -50%) translate3d(0, 0, 0); transition: transform 0.5s ease;"></div>
      </div>
    </div>
  </div>
</div>
         <!-- Hall Sensor with C-shaped Arc -->
            <div id="hall-card" class="card-container" style="display: none;">
              <h4>Hall Sensor</h4>
              <div id="hall-value" class="sensor-value"></div>
              <svg id="hallCshape" viewBox="0 0 100 100"> …C path… </svg>
              <svg id="hall-arc" width="80" height="80" viewBox="0 0 100 100">
                <defs>
                  <filter id="hall-glow" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="0" result="coloredBlur"/>
                    <feMerge>
                      <feMergeNode in="coloredBlur"/>
                      <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                <path id="hall-arc-path" d="M 20 80 A 30 30 0 1 1 80 80" fill="none" stroke="#f44336" stroke-width="8" stroke-linecap="round"/>
              </svg>
            </div>

        <div id="tlv493d-card" class="card-container" style="display: none;">
            <h4>Magnetic Field</h4>
            <div id="tlv493d-x-value" class="sensor-value">X: 0.00 mT</div>
            <div id="tlv493d-y-value" class="sensor-value">Y: 0.00 mT</div>
            <div id="tlv493d-z-value" class="sensor-value">Z: 0.00 mT</div>
            <div class="tlv493d-simple-container">
              <svg width="150" height="150" viewBox="0 0 100 100">
                <line class="axis-line" x1="10" y1="50" x2="90" y2="50" /> <line class="axis-line" x1="50" y1="10" x2="50" y2="90" /> <text class="axis-label" x="92" y="55">+X</text>
                <text class="axis-label" x="2" y="55">-X</text>
                <text class="axis-label" x="45" y="8">+Y</text>
                <text class="axis-label" x="45" y="98">-Y</text>
                
                <circle id="z-axis-indicator" class="sensor-origin" cx="50" cy="50" r="8" />

                <circle id="max-axis-indicator" class="indicator-dot" cx="50" cy="50" r="6" />
              </svg>
            </div>
          </div>

           <!-- TOFVL53L0X Distance -->
            <div id="tof-card" class="card-container" style="display: none; height: 150px;">
              <h4>Distance</h4>
              <div id="tof-value" class="sensor-value"></div>
              <svg id="tof-animation" width="220" height="100" viewBox="0 0 220 100">
                <rect x="5" y="45" width="10" height="10" fill="blue"/> <!-- Sensor -->
                <line x1="0" y1="75" x2="220" y2="75" stroke="#ccc" stroke-width="2"/> <!-- Ground line -->
                <g id="tof-person" transform="translate(20, 0)">
                  <circle cx="5" cy="20" r="5" fill="var(--person-color)"/> <!-- Head -->
                  <line x1="5" y1="25" x2="5" y2="55" stroke="var(--person-color)" stroke-width="2"/> <!-- Body -->
                  <line x1="5" y1="30" x2="-5" y2="40" stroke="var(--person-color)" stroke-width="2"/> <!-- Left arm -->
                  <line x1="5" y1="30" x2="15" y2="40" stroke="var(--person-color)" stroke-width="2"/> <!-- Right arm -->
                  <line x1="5" y1="55" x2="-5" y2="75" stroke="var(--person-color)" stroke-width="2"/> <!-- Left leg -->
                  <line x1="5" y1="55" x2="15" y2="75" stroke="var(--person-color)" stroke-width="2"/> <!-- Right leg -->
                </g>
                <text x="0" y="95" font-size="10">0cm</text>
                <text x="190" y="95" font-size="10">850cm</text>
              </svg>
            </div>


           <!-- UVLTR390 UV Index with Enhanced Sun Animation -->
            <div id="uvltr-card" class="card-container" style="display: none; position: relative;">
              <h4>UV Index</h4>
              <div id="uv-value" class="sensor-value">UV: 0.00</div>
              <svg id="uv-sun" width="120" height="120" viewBox="0 0 120 120" style="display: block; margin: 10px auto;">
                <defs>
                  <radialGradient id="uvSunGradient" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" style="stop-color:#ffeb3b; stop-opacity:1"/>
                    <stop offset="60%" style="stop-color:#ff9800; stop-opacity:0.8"/>
                    <stop offset="100%" style="stop-color:#ff6b00; stop-opacity:0.4"/>
                  </radialGradient>
                  <filter id="uvGlow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                    <feMerge>
                      <feMergeNode in="coloredBlur"/>
                      <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                
                <!-- Animated rays container -->
                <g id="uv-rays" transform="translate(60, 60)">
                  <!-- 8 rays at different angles -->
                  <line class="uv-ray" x1="0" y1="0" x2="0" y2="-35" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-30;-40;-30" dur="2s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="25" y2="-25" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="0.25s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="21;28;21" dur="2s" begin="0.25s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-21;-28;-21" dur="2s" begin="0.25s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="35" y2="0" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="0.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="30;40;30" dur="2s" begin="0.5s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="25" y2="25" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="0.75s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="21;28;21" dur="2s" begin="0.75s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="21;28;21" dur="2s" begin="0.75s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="0" y2="35" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="1s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="30;40;30" dur="2s" begin="1s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="-25" y2="25" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="1.25s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-21;-28;-21" dur="2s" begin="1.25s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="21;28;21" dur="2s" begin="1.25s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="-35" y2="0" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="1.5s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-30;-40;-30" dur="2s" begin="1.5s" repeatCount="indefinite"/>
                  </line>
                  <line class="uv-ray" x1="0" y1="0" x2="-25" y2="-25" stroke="#ffeb3b" stroke-width="2" opacity="0">
                    <animate attributeName="opacity" values="0;0.8;0" dur="2s" begin="1.75s" repeatCount="indefinite"/>
                    <animate attributeName="x2" values="-21;-28;-21" dur="2s" begin="1.75s" repeatCount="indefinite"/>
                    <animate attributeName="y2" values="-21;-28;-21" dur="2s" begin="1.75s" repeatCount="indefinite"/>
                  </line>
                </g>
                
                <!-- Central sun circle -->
                <circle id="uv-sun-circle" cx="60" cy="60" r="18" fill="url(#uvSunGradient)" filter="url(#uvGlow)"/>
                
                <!-- Inner glow circle -->
                <circle cx="60" cy="60" r="18" fill="none" stroke="#fff" stroke-width="1" opacity="0.3">
                  <animate attributeName="r" values="18;22;18" dur="3s" repeatCount="indefinite"/>
                  <animate attributeName="opacity" values="0.3;0.1;0.3" dur="3s" repeatCount="indefinite"/>
                </circle>
              </svg>
              <div id="uv-bar" class="card-bar"></div>
            </div>

          <!-- IR Sensor -->
<div id="ir-card" class="card-container" style="display: none;">
  <h4>IR Sensor</h4>
  <div id="ir-value" class="sensor-value"></div>
  <svg id="ir-bulb" width="80" height="80" viewBox="0 0 100 100">
    <defs>
      <filter id="ir-glow" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="0" result="coloredBlur"/>
        <feMerge>
          <feMergeNode in="coloredBlur"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <circle id="ir-bulb-circle" cx="50" cy="50" r="30" fill="#ccc" stroke="#333" stroke-width="2"/>
    <path id="ir-bulb-base" d="M 35 80 H 65 V 90 H 35 Z" fill="#666"/>
  </svg>
</div>
          </div>
        </section>

        <section class="control-section">
          <h3><i class="fas fa-file-alt"></i> UART Logs</h3>
          <div class="controls">
            <button class="action-button" onclick="clearOutput()"><i class="fas fa-trash"></i> Clear Logs</button>
          </div>
          <div id="output"></div>
        </section>
      </div>
    </div>
  </div>

  <footer>
    <p><i class="fas fa-copyright"></i> IOT Serial Monitor App © 2025</p>
  </footer>

  <script src="renderer.js"></script>
  <script>
  let isLedOn = false;

  function restartDevice() {
    sendCommand('Restart Device');
    document.getElementById('output').innerHTML += 'Sent RESTART command to device.<br>';
    const button = document.getElementById('restart-button');
    button.disabled = true;
    setTimeout(() => {
      button.disabled = false;
    }, 5000);
  }

  function toggleTheme() {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
    const icon = document.querySelector('.theme-toggle i');
    icon.className = document.body.classList.contains('dark-mode') ? 'fas fa-sun' : 'fas fa-moon';
  }

  function clearOutput() {
    document.getElementById('output').innerHTML = '';
  }

  // Function to check if any sensor has data and update visibility
  function updateSensorVisualizationVisibility() {
    const visualizationSection = document.getElementById('sensor-visualization-section');
    
    // List of sensor value elements to check
    const sensorValues = [
      document.getElementById('thermometer-value').textContent,
      document.getElementById('humidity-value').textContent,
      document.getElementById('pressure-value').textContent,
      document.getElementById('light-value').textContent,
      document.getElementById('lis3dh-x-value').textContent,
      document.getElementById('hall-value').textContent,
      document.getElementById('tlv493d-x-value').textContent,
      document.getElementById('tof-value').textContent,
      document.getElementById('uv-value').textContent,
      document.getElementById('ir-value').textContent
    ];

   // Check if any sensor has non-empty data (relaxed: show even if zero, but hide if empty/undefined)
  const hasData = sensorValues.some(value => value && value.trim() !== '');

  // Show or hide the entire visualization section
  visualizationSection.style.display = hasData ? 'block' : 'none';
}

  // Override updateSensorUI to include visibility check
  const originalUpdateSensorUI = window.updateSensorUI || function() {};
  window.updateSensorUI = function() {
    originalUpdateSensorUI();
    updateSensorVisualizationVisibility();
  };

  // Override selectSensor to include visibility check
  const originalSelectSensor = window.selectSensor || function() {};
  window.selectSensor = function(value) {
    originalSelectSensor(value);
    updateSensorVisualizationVisibility();
  };

  // Apply saved theme on page load
  if (localStorage.getItem('theme') === 'dark') {
    document.body.classList.add('dark-mode');
    document.querySelector('.theme-toggle i').className = 'fas fa-sun';
  }

  // Initial check for visualization visibility
  updateSensorVisualizationVisibility();
</script>
</body>
</html>